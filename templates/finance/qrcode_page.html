{% extends 'base.html' %}
{% load humanize %}

{% block title %}QR Code Invoice #INV-{{ invoice.id }}{% endblock %}

{% block content %}
<div class="max-w-md mx-auto text-center">
    <div class="mb-6 flex justify-between items-center no-print">
        <a href="{% url 'invoice_list' %}" class="btn btn-ghost btn-sm">
            <i data-lucide="arrow-left"></i> Kembali
        </a>
        <button onclick="window.print()" class="btn btn-primary btn-sm">
            <i data-lucide="printer"></i> Cetak
        </button>
    </div>

    <div class="bg-white p-8 rounded-box shadow-lg inline-block border border-gray-200">
        <h2 class="text-xl font-bold mb-1 text-black">INVOICE #INV-{{ invoice.id }}</h2>
        <p class="text-gray-600 mb-4">{{ invoice.reseller.name }}</p>
        
        <div class="flex justify-center bg-white p-4">
            <div id="qrcode"></div>
        </div>
        
        <div class="mt-4 text-black">
            <div class="text-sm opacity-70">Total Tagihan:</div>
            <div class="text-2xl font-bold">Rp {{ invoice.total_amount|floatformat:0|intcomma }}</div>
        </div>
        
        <p class="mt-6 text-xs text-gray-400 font-mono">Scan QR di atas untuk melihat rincian transaksi</p>
    </div>

    <div class="mt-10 no-print text-left">
        <div class="card bg-base-100 shadow-sm border border-base-200">
            <div class="card-body p-4">
                <h3 class="font-bold flex items-center gap-2">
                    <i data-lucide="info" class="w-4 h-4"></i> Informasi QR Code
                </h3>
                <p class="text-sm">QR Code ini berisi ID Invoice yang dapat di-scan melalui aplikasi Stock Center untuk memvalidasi atau melihat detail transaksi dengan cepat.</p>
            </div>
        </div>
    </div>
</div>

<style>
    @media print {
        .no-print { display: none; }
        body { background: white; padding: 0; }
        .container { max-width: 100%; width: 100%; margin: 0; padding: 0; }
    }
</style>

<!-- QRCode.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
    new QRCode(document.getElementById("qrcode"), {
        text: "INV-{{ invoice.id }}",
        width: 200,
        height: 200,
        colorDark : "#000000",
        colorLight : "#ffffff",
        correctLevel : QRCode.CorrectLevel.H
    });
</script>
{% endblock %}
